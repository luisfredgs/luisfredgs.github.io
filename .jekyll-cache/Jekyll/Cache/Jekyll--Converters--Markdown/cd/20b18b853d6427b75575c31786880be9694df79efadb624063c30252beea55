I"¶&<p class="image"><img src="/blog/assets/img/como-o-youtube-usa-o-deep-learning-para-saber-qual-e-o-proximo-video-que-voce-quer-assistir.png" alt="" /></p>

<p class="intro"><em>J√° percebeu que quando voc√™ acessa a p√°gina inicial do Youtube, os v√≠deos que aparecem convenientemente logo no topo t√™m a mais alta probabilidade de serem os v√≠deos que voc√™ gostaria de ver? Voc√™ j√° se perguntou como a maior plataforma de v√≠deos do mundo sabe qual √© o pr√≥ximo v√≠deo que voc√™ quer assistir? Ao final deste post, voc√™ ter√° uma ideia de como o Youtube utiliza o deep learning para chegar a este resultado.</em></p>

<p>A Google recentemente deu um grande passo em dire√ß√£o √† pr√≥xima gera√ß√£o de seus aplicativos baseados em intelig√™ncia artificial, introduzindo tecnologia neural que vem garantindo performances no <a href="https://pt.wikipedia.org/wiki/Estado_da_arte">estado da arte</a>. Um grande exemplo disto √© a segunda gera√ß√£o do Google Tradutor, no qual os modelos estat√≠sticos de tradu√ß√£o foram substitu√≠dos por uma nova abordagem chamada <strong>Neural Machine Translation</strong> (Tradu√ß√£o Neural de M√°quina), conforme voc√™ poder√° conferir <a href="https://blog.google/products/translate/found-translation-more-accurate-fluent-sentences-google-translate/">neste post</a>, no blog da Google.</p>

<p>Um outro produto Google que passou por uma mudan√ßa similar recentemente foi o Youtube, no qual passaram a adotar t√©cnicas de <em>deep learning</em> com o objetivo de predizer qual √© o pr√≥ximo v√≠deo que n√≥s queremos assistir na plataforma, constituindo a base para o seu novo sistema de recomenda√ß√£o. Os resultados da pesquisa foram descritos e compartilhados <a href="https://static.googleusercontent.com/media/research.google.com/pt-BR//pubs/archive/45530.pdf">neste paper</a>.</p>

<p>A vers√£o anterior deste sistema de recomenda√ß√£o contava com uma abordagem baseada em <strong>fatora√ß√£o de matrizes</strong>, em conjunto com a <strong>filtragem colaborativa</strong>, a qual se baseia, por sua vez, no feedback dado pelos usu√°rios (likes, views, etc). Um <em>paper</em> interessante sobre este assunto pode ser <a href="https://arxiv.org/ftp/arxiv/papers/1503/1503.07475.pdf">encontrado aqui</a>. O novo sistema de recomenda√ß√£o √© composto por duas redes neurais, cada uma respons√°vel por uma tarefa espec√≠fica: <strong><em>gera√ß√£o de candidatos</em></strong> e <strong>*rankeamento</strong>, *respectivamente. A figura abaixo mostra uma vis√£o geral do funcionamento deste sistema.</p>

<p class="image"><img src="https://cdn-images-1.medium.com/max/2048/0*xQJC_w0RS_AF78M6.png" alt="" /></p>

<h3 id="gera√ß√£o-de-candidatos">Gera√ß√£o de candidatos</h3>

<p>Esta rede neural gera uma lista dos v√≠deos que t√™m a maior probabilidade de serem relevantes para quem estiver acessando a plataforma a qualquer momento. Utiliza como entrada, informa√ß√µes baseadas no hist√≥rico de atividades dos usu√°rios. Nesta etapa, a filtragem colaborativa torna-se um elemento importante, pois se baseia em determinadas a√ß√µes dos usu√°rios que constituem-se num forte indicativo de que um determinado v√≠deo seja relevante. Se, por exemplo, um v√≠deo espec√≠fico foi assistido na √≠ntegra por v√°rias pessoas, isto pode ser um grande sinal de que este v√≠deo seja relevante dentro do contexto no qual esteja inserido. A quantidade de <em>likes</em> que este v√≠deo recebeu tamb√©m √© um importante feedback a ser utilizado como entrada. A similaridade entre os usu√°rios que assistem ao v√≠deo se baseia em determinadas caracter√≠sticas compartilhadas entre eles, tais como os dados demogr√°ficos, textos utilizados no campo de busca, v√≠deos que assistiram, de que maneira eles descobrem novos v√≠deos, etc. Esta similaridade tamb√©m ‚Äúentra no jogo‚Äù.</p>

<h3 id="rankeamento">Rankeamento</h3>

<p>Para que o sistema de recomenda√ß√£o consiga ser realmente efetivo, √© preciso que seja garantido um alto valor para o recall (<em>a fra√ß√£o dos v√≠deos que s√£o realmente relevantes em rela√ß√£o ao n√∫mero total de registros candidatos gerados</em>). A rede neural de rankeamento possibilita isto ao atribuir um score para cada v√≠deo, com base numa <em>fun√ß√£o objetivo</em> que utiliza um maci√ßo conjunto informa√ß√µes capazes de descrever tanto os v√≠deos quanto os usu√°rios que os assistem. Apenas os v√≠deos com scores mais altos ser√£o exibidos na lista como recomenda√ß√£o para os usu√°rios, rankeados com base em seu score.</p>

<h3 id="arquitetura-do-modelo">Arquitetura do modelo</h3>

<p>Essencialmente, o novo sistema de recomenda√ß√£o do Youtube √© um problema de classifica√ß√£o em m√∫ltiplas classes (na ordem de milh√µes), na qual o modelo recebe bilh√µes de par√¢metros como entrada. A figura abaixo ilustra a arquitetura da rede neural utilizada para selecionar v√≠deos que tenham maiores probabilidades se serem relevantes para os usu√°rios (gera√ß√£o de registros candidatos), dentro do contexto espec√≠fico de cada um.</p>

<p class="image"><img src="https://cdn-images-1.medium.com/max/2612/0*HvOGyZS-gHoYQ0c2.png" alt="" /></p>

<p>√â poss√≠vel perceber que a rede, cujo fluxo se d√° de baixo para cima, recebe como entrada algumas features incorporadas, tais como a m√©dia dos v√≠deos visualizados, dos <em>tokens</em> que formam os textos digitados no campo de busca, √°reas geogr√°ficas dos usu√°rios, o g√™nero deles, a quanto tempo o v√≠deo est√° publicado na plataforma, etc. A m√©dia destes dados incorporados em representa√ß√£o vetorial √© calculada imediatamente antes de eles serem concatenados, com o objetivo de fixar o tamanho dos vetores, de modo a adequ√°-los √† entrada nas camadas ocultas da rede profunda. Todas as camadas ocultas s√£o totalmente conectadas (cada n√≥ em uma camada est√° conectado a todos os n√≥s da camada anterior e tamb√©m da camada seguinte). Durante a fase de treino, a fun√ß√£o de perda √© minimizada por meio da t√©cnica do gradiente descendente na sa√≠da da fun√ß√£o <em>softmax *(respons√°vel por representar a probabilidade de classe). Em seguida, √© feita uma procura pelo registro vizinho mais pr√≥ximo de modo a determinar os <strong>*N</strong></em> v√≠deos mais relevantes a serem exibidos na lista.</p>

<p>Considerando que os usu√°rios normalmente preferem conte√∫do mais novo e atualizado, o sistema precisa levar em conta, ainda, as milhares de horas em v√≠deo que s√£o enviadas para a plataforma a cada minuto. Ou seja, os novos v√≠deos tamb√©m precisam ‚Äúentrar na lista‚Äù para serem recomendados. Os dados de treino utilizados para ‚Äúensinar‚Äù a rede s√£o gerados a partir de TODOS os v√≠deos visualizados na plataforma, at√© mesmo aqueles que est√£o incorporados em p√°ginas de sites externos.</p>

<p>Uma arquitetura similar √†quela utilizada na fase de gera√ß√£o de candidatos entra em a√ß√£o logo em seguida, para rankear os registros candidatos obtidos por meio da rede ilustrada na figura anterior. A diferen√ßa neste ponto √© que os pesquisadores utilizaram <em>regress√£o log√≠stica</em> para atribuir um score independente √† cada v√≠deo a ser exibido na lista de recomendados. A figura abaixo ilustra este procedimento:</p>

<p class="image"><img src="https://cdn-images-1.medium.com/max/2128/0*lScbklnqqXgm8NtA.png" alt="" /></p>

<p>Centenas de features (idioma do v√≠deo, exibi√ß√µes anteriores na lista de recomenda√ß√£o, quanto tempo levou desde que cada v√≠deo candidato foi visto pela √∫ltima vez, quantos v√≠deos do canal em quest√£o foram vistos pelo usu√°rio, quando foi a √∫ltima vez que o usu√°rio assistiu a um v√≠deo do t√≥pico em quest√£o, etc) alimentam a rede, que possui todas as suas camadas completamente conectadas, tal como ocorre na rede neural para gera√ß√£o de candidatos. Nesta etapa, a lista de v√≠deos recomendados √© ordenada de acordo com o score atribu√≠do a cada v√≠deo e, ent√£o, exibida na tela do usu√°rio.</p>

<p>Em ambos os modelos, as features s√£o conectadas em uma primeira camada mais larga, ao passo em que as camadas seguintes s√£o completamente conectadas e compostas de Unidades Lineares Retificadas (<a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)">ReLU</a>) como fun√ß√µes de ativa√ß√£o.</p>

<p>Parte do processo de cria√ß√£o do modelo se deu de modo offline. No entanto, para determinar a efetividade do modelo, os pesquisadores fizeram experimentos em produ√ß√£o com base em testes A/B, pois assim conseguiriam medir mudan√ßas sutis, tais como: taxas de cliques, tempo de visualiza√ß√£o e muitas outras m√©tricas que medem o engajamento dos usu√°rios.</p>

<p>O sistema de recomenda√ß√µes do Youtube √© respons√°vel por ajudar mais de um bilh√£o de usu√°rios a encontrar conte√∫do personalizado diariamente, nesta que √© a maior plataforma de v√≠deos do mundo. Para o sistema em si, trata-se de uma tarefa que envolve um desafio imenso, considerando a necessidade de obter uma boa performance numa escala t√£o grande e num intervalo de tempo que fica na ordem dos milissegundos. Da pr√≥xima vez em que voc√™ acessar a p√°gina inicial do Youtube e ver todos aqueles v√≠deos que combinam exatamente com o que voc√™ mais gosta de assistir, ter√° uma boa ideia do que √© preciso para que esta ‚Äúm√°gica‚Äù aconte√ßa.</p>

<ul>
  <li>
    <p><a href="/livros/7-livros-essenciais-para-aprender-machine-learning">7 livros essenciais para aprender machine learning</a></p>
  </li>
  <li>
    <p><a href="/deep-learning/analise-de-sentimentos-usando-redes-neurais">An√°lise de sentimentos com redes neurais recorrentes LSTM</a></p>
  </li>
  <li>
    <p><a href="/deep-learning/reconhecimento-de-entidades-nomeadas-ner-e-aplicacoes">Reconhecimento de Entidades Nomeadas (NER) ‚Äî O que √©? Quais s√£o as aplica√ß√µes?</a></p>
  </li>
  <li>
    <p><a href="/machine-learning/classificando-textos-com-machine-learning">Classificando textos com Machine Learning</a></p>
  </li>
</ul>
:ET